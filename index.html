<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Forest</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css" rel="stylesheet">
<style>
  body { transition: background-image 0.7s ease-in-out; }
  textarea { resize: none; }
</style>
</head>
<body class="min-h-screen flex flex-col bg-gray-100">

<header class="bg-white shadow-sm">
  <div class="max-w-4xl mx-auto flex items-center justify-between p-4">
    <h1 class="text-xl font-bold">Digital Forest</h1>
    <nav class="flex gap-3">
      <button onclick="navigate('home')" id="nav-home" class="px-3 py-1 rounded bg-green-100">í™ˆ</button>
      <button onclick="navigate('diary')" id="nav-diary" class="px-3 py-1 rounded">ê°ì •ì¼ê¸°</button>
      <button onclick="navigate('shared')" id="nav-shared" class="px-3 py-1 rounded">ê³µìœ ì˜ ìˆ²</button>
    </nav>
  </div>
</header>

<main class="flex-1 max-w-4xl mx-auto w-full p-6" id="main-content"></main>

<footer class="p-4 text-center text-xs text-gray-600">Digital Forest â€” ë¡œì»¬ ë°ëª¨. ìµëª…ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.</footer>

<script>
const MOODS = {
  tired: { label: 'ì§€ì¹¨', bg: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=60', audio: 'https://cdn.pixabay.com/download/audio/2022/03/14/audio_1b02f1b4f3.mp3', desc: 'ë‚˜ë¬´ ì‚¬ì´ í–‡ì‚´ì´ ì²œì²œíˆ ì—ë„ˆì§€ë¥¼ ì±„ì›Œì¤ë‹ˆë‹¤.'},
  anxious: { label: 'ë¶ˆì•ˆ', bg: 'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=60', audio: 'https://cdn.pixabay.com/download/audio/2022/03/22/audio_4f81e8c4bb.mp3', desc: 'ê¹Šì€ ìˆ¨ê³¼ ì”ì”í•œ ìˆ²ì†Œë¦¬ê°€ ê¸´ì¥ì„ í’€ì–´ì¤ë‹ˆë‹¤.'},
  depressed: { label: 'ìš°ìš¸', bg: 'https://images.unsplash.com/photo-1506084868230-bb9d95c24759?auto=format&fit=crop&w=1400&q=60', audio: 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_148c4b3482.mp3', desc: 'ì”ì”í•œ ë¬¼ê²°ì´ ë§ˆìŒì„ ë‹¬ë˜ì¤ë‹ˆë‹¤.'},
  angry: { label: 'í™”ë‚¨', bg: 'https://images.unsplash.com/photo-1503435824048-a799cd2a0bfd?auto=format&fit=crop&w=1400&q=60', audio: 'https://cdn.pixabay.com/download/audio/2022/03/15/audio_8a4a8c39e1.mp3', desc: 'ë”°ìŠ¤í•œ í–‡ì‚´ì´ ì„œì„œíˆ ë¶„ë…¸ë¥¼ ë…¹ì—¬ì¤ë‹ˆë‹¤.'},
  unpleasant: { label: 'ë¶ˆì¾Œ', bg: 'https://images.unsplash.com/photo-1506765515384-028b60a970df?auto=format&fit=crop&w=1400&q=60', audio: 'https://cdn.pixabay.com/download/audio/2021/09/06/audio_10d4b2c2e3.mp3', desc: 'ë§‘ì€ ê³µê¸°ì™€ ìƒˆì†Œë¦¬ê°€ ìƒì¾Œí•¨ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.'}
};

const COMFORT_PHRASES = ['ë‹¹ì‹ ì˜ ê°ì •ì€ ìœ íš¨í•´ìš”.', 'ìˆ¨ì„ ê¹Šê²Œ ë“¤ì´ì‰¬ê³  ì²œì²œíˆ ë‚´ì‰¬ì–´ ë³´ì„¸ìš”.', 'ì§€ê¸ˆì˜ ë‹¹ì‹ ë„ ì¶©ë¶„íˆ ì˜í•˜ê³  ìˆì–´ìš”.', 'ì‘ì€ ì‰¼ì´ í° íšŒë³µìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤.', 'ìˆ²ì€ ëŠ˜ ê·¸ ìë¦¬ì— ìˆì–´ìš”. ì ì‹œ ì‰¬ì–´ê°€ë„ ì¢‹ì•„ìš”.'];
const STORAGE_KEY = 'digital_forest_entries_html';
let currentMood = 'tired';
let entries = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

function navigate(route){
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('bg-green-100'));
  document.getElementById('nav-'+route).classList.add('bg-green-100');
  if(route==='home'){ renderHome(); }
  else if(route==='diary'){ renderDiary(); }
  else if(route==='shared'){ renderShared(); }
}

function renderHome(){
  document.getElementById('main-content').innerHTML = `
    <div class="rounded-2xl overflow-hidden shadow-lg relative" style="background-image:url(${MOODS[currentMood].bg}); background-size:cover; background-position:center; min-height:300px;">
      <div class="p-8 bg-gradient-to-t from-black/40 to-transparent text-white">
        <h2 class="text-3xl font-bold">ë‹¹ì‹ ì˜ ë§ˆìŒì´ ì‰´ ìˆ˜ ìˆëŠ” ìˆ²ìœ¼ë¡œ</h2>
        <p class="mt-2">ì§§ì€ ì‹œê°„ì„ ë‚´ì–´ ìˆ¨ì„ ê³ ë¥´ê³ , ìì—°ì„ ë– ì˜¬ë ¤ ë³´ì„¸ìš”.</p>
        <div class="mt-4 flex gap-3 flex-wrap">
          ${Object.keys(MOODS).map(k=>`<button onclick="setMood('${k}')" class="px-3 py-2 rounded bg-white/30">${MOODS[k].label}</button>`).join('')}
          <button onclick="playSound()" class="px-3 py-2 rounded bg-white">ì‚¬ìš´ë“œ ì¬ìƒ</button>
        </div>
        <audio id="audio-player"></audio>
      </div>
    </div>
  `;
}

function renderDiary(){
  document.getElementById('main-content').innerHTML = `
    <div class="grid md:grid-cols-2 gap-6">
      <div class="rounded-lg overflow-hidden" style="background-image:url(${MOODS[currentMood].bg}); background-size:cover; background-position:center; min-height:220px;">
        <div class="p-6 bg-gradient-to-t from-black/40 to-transparent text-white h-full">
          <h3 class="text-2xl font-bold">ì˜¤ëŠ˜ì˜ ê¸°ë¶„: ${MOODS[currentMood].label}</h3>
          <p class="mt-2">${MOODS[currentMood].desc}</p>
          <button onclick="playSound()" class="mt-4 px-3 py-2 rounded bg-white text-sm">ì‚¬ìš´ë“œ ì¬ìƒ</button>
          <audio id="audio-player"></audio>
        </div>
      </div>
      <div class="bg-white rounded-lg p-4 shadow">
        <h4 class="font-semibold">ê°ì • ì¼ê¸°</h4>
        <div class="mt-3 flex gap-2 flex-wrap">
          ${Object.keys(MOODS).map(k=>`<button onclick="setMood('${k}')" class="px-3 py-1 rounded ${currentMood===k?'bg-green-100':''}">${MOODS[k].label}</button>`).join('')}
        </div>
        <textarea id="diary-text" placeholder="ì§€ê¸ˆ ëŠë¼ëŠ” ê°ì •ì„ ì ì–´ë³´ì„¸ìš”..." class="w-full mt-3 h-40 p-2 border rounded"></textarea>
        <div class="flex items-center gap-3 mt-3">
          <button onclick="saveDiary()" class="px-4 py-2 rounded bg-green-200">ì €ì¥í•˜ê¸°</button>
          <span id="message" class="text-sm text-green-700"></span>
        </div>
      </div>
    </div>
  `;
}

function renderShared(){
  document.getElementById('main-content').innerHTML = `
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-bold">ê³µìœ ì˜ ìˆ² â€” ìµëª… ì¼ê¸°</h3>
      <button onclick="clearAll()" class="px-3 py-1 rounded bg-red-100 text-sm">ëª¨ë‘ ì‚­ì œ</button>
    </div>
    ${entries.length===0?'<div class="bg-white p-6 rounded shadow text-center">ì•„ì§ ì €ì¥ëœ ì¼ê¸°ê°€ ì—†ì–´ìš”. ë‹¹ì‹ ì˜ ì²« ë‚˜ë­‡ìì´ ë˜ì–´ë³¼ë˜ìš”?</div>':''}
    <div class="grid gap-3">
      ${[...entries].sort((a,b)=>b.id-a.id).map((e,idx)=>`<div class="bg-white p-4 rounded shadow"><div class="flex items-center justify-between text-xs text-gray-500"><div>ìµëª… ë‚˜ë­‡ì ğŸŒ¿ #${entries.length-idx}</div><div>${new Date(e.ts).toLocaleString()}</div></div><div class="mt-2 text-sm"><strong class="text-sm mr-2">ê¸°ë¶„: ${MOODS[e.mood]?.label || e.mood}</strong><div class="mt-1">${e.text}</div></div></div>`).join('')}
    </div>
  `;
}

function setMood(mood){ currentMood=mood; navigate('diary'); }

function playSound(){
  const audio = document.getElementById('audio-player');
  if(audio){ audio.src = MOODS[currentMood].audio; audio.play().catch(()=>{}); }
}

function saveDiary(){
  const text = document.getElementById('diary-text').value.trim();
  if(!text){ document.getElementById('message').innerText='ì¼ê¸°ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.'; setTimeout(()=>document.getElementById('message').innerText='',2000); return; }
  const entry={id:Date.now(), mood:currentMood, text, ts:new Date().toISOString()};
  entries.push(entry);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
  document.getElementById('diary-text').value='';
  document.getElementById('message').innerText = COMFORT_PHRASES[Math.floor(Math.random()*COMFORT_PHRASES.length)];
  setTimeout(()=>document.getElementById('message').innerText='',3000);
}

function clearAll(){ if(confirm('ë¡œì»¬ì— ì €ì¥ëœ ëª¨ë“  ì¼ê¸°ë¥¼ ì‚­ì œí•˜ì‹œê² ì–´ìš”?')){ entries=[]; localStorage.removeItem(STORAGE_KEY); navigate('shared'); } }

navigate('home');
</script>

</body>
</html>
